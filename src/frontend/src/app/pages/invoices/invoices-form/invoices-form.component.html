<div class="max-w-2xl mx-auto px-6 py-8">
  <div class="flex items-center gap-4 mb-6">
    <button (click)="back()" class="text-neutral-400 hover:text-neutral-600 transition">
      <lucide-icon [img]="ArrowLeft" size="20"></lucide-icon>
    </button>
    <h2 class="text-2xl font-bold text-neutral-800">
      {{ id() ? 'Editar Factura' : 'Nueva Factura' }}
    </h2>
  </div>

  @if (error()) {
    <div class="bg-red-100 text-red-700 px-4 py-2 rounded-lg mb-4 text-sm">
      {{ error() }}
    </div>
  }

  <div class="bg-white rounded-2xl shadow-sm border border-neutral-100 p-6 flex flex-col gap-4">
    <div>
      <label class="block text-sm font-medium text-neutral-700 mb-1">Paciente</label>
      <select
        [value]="form().pacienteId"
        (change)="updateField('pacienteId', +$any($event.target).value)"
        class="w-full border border-neutral-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
      >
        <option value="0" disabled>Selecciona un paciente</option>
        @for (patient of patients(); track patient.id) {
          <option [value]="patient.id">{{ patient.nombre }} {{ patient.apellido }}</option>
        }
      </select>
    </div>

    <div>
      <label class="block text-sm font-medium text-neutral-700 mb-1">Descripción</label>
      <textarea
        [value]="form().descripcion"
        (input)="updateField('descripcion', $any($event.target).value)"
        rows="3"
        placeholder="Descripción de la factura"
        class="w-full border border-neutral-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
      >
      </textarea>
    </div>

    <div>
      <label class="block text-sm font-medium text-neutral-700 mb-1">Total ($)</label>
      <input
        type="number"
        [value]="form().total"
        (input)="updateField('total', +$any($event.target).value)"
        placeholder="0.00"
        min="0"
        step="0.01"
        class="w-full border border-neutral-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
    </div>

    <div>
      <label class="block text-sm font-medium text-neutral-700 mb-1">Fecha</label>
      <input
        type="date"
        [value]="form().fecha"
        (change)="updateField('fecha', $any($event.target).value)"
        class="w-full border border-neutral-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
    </div>

    <button
      (click)="save()"
      class="flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-lg transition duration-200 mt-2"
    >
      <lucide-icon [img]="Save" size="18"></lucide-icon>
      {{ id() ? 'Actualizar' : 'Guardar' }}
    </button>
  </div>
</div>
